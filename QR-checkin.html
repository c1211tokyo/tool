<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>æ°‘å®¿å…¥ä½æŒ‡å—</title>
  <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
  <style>
    :root {
      --bg-color: #0d0d0f;
      --card-bg: #1a1a1d;
      --primary: #4a7bee;
      --text-main: #ffffff;
      --text-sub: #aaaaaa;
    }

    body {
      font-family: "Inter", -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-color);
      color: var(--text-main);
      margin: 0;
      padding: 20px;
      line-height: 1.6;
    }

    .container {
      max-width: 600px;
      margin: 0 auto;
    }

    /* --- ç¼–è¾‘æ¨¡å¼æ ·å¼ (ç”Ÿæˆå™¨) --- */
    #editor-mode {
      display: none; /* é»˜è®¤éšè—ï¼ŒJSæ§åˆ¶æ˜¾ç¤º */
    }
    
    .input-card {
      background: var(--card-bg);
      padding: 25px;
      border-radius: 16px;
      border: 1px solid #333;
      box-shadow: 0 8px 24px rgba(0,0,0,0.2);
    }

    label {
      display: block;
      margin-top: 15px;
      color: var(--text-sub);
      font-size: 14px;
      font-weight: bold;
    }

    input, textarea {
      width: 100%;
      padding: 12px;
      margin-top: 8px;
      background: #252528;
      border: 1px solid #444;
      border-radius: 8px;
      color: #fff;
      box-sizing: border-box;
      font-size: 15px;
    }

    button.generate-btn {
      width: 100%;
      padding: 16px;
      margin-top: 30px;
      background: var(--primary);
      border: none;
      border-radius: 8px;
      color: #fff;
      font-size: 16px;
      font-weight: bold;
      cursor: pointer;
    }

    #qr-result {
      margin-top: 30px;
      text-align: center;
      padding: 20px;
      background: #fff;
      border-radius: 12px;
      display: none;
    }
    #qr-result p { color: #333; margin-bottom: 10px; }

    /* --- è®¿å®¢æ¨¡å¼æ ·å¼ (å±•ç¤ºé¡µ) --- */
    #guest-mode {
      display: none; /* é»˜è®¤éšè— */
    }

    .guest-header {
      text-align: center;
      margin-bottom: 30px;
    }
    .guest-header h1 { margin: 0; font-size: 24px; }
    .guest-header p { color: var(--text-sub); margin-top: 5px; }

    .info-section {
      background: var(--card-bg);
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 15px;
      border: 1px solid #333;
    }

    .info-title {
      font-size: 18px;
      font-weight: bold;
      color: var(--primary);
      display: flex;
      align-items: center;
      margin-bottom: 12px;
    }
    .info-title i { margin-right: 8px; }

    .info-content {
      font-size: 15px;
      white-space: pre-wrap; /* ä¿ç•™æ¢è¡Œ */
      color: #ddd;
    }

    /* å¤åˆ¶æŒ‰é’®æ ·å¼ */
    .copy-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background: #252528;
      padding: 10px 15px;
      border-radius: 8px;
      margin-top: 8px;
    }
    .copy-btn {
      background: rgba(74, 123, 238, 0.2);
      color: #4a7bee;
      border: none;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 12px;
      cursor: pointer;
    }
    .copy-btn:active { background: rgba(74, 123, 238, 0.4); }

    /* åº•éƒ¨æŒ‰é’® */
    .footer-btn {
      text-align: center;
      margin-top: 40px;
    }
    .footer-btn a {
      color: #666;
      text-decoration: none;
      font-size: 12px;
    }
  </style>
</head>
<body>

<div class="container">

  <div id="editor-mode">
    <h1 style="text-align:center">ğŸ› ï¸ å…¥ä½å¡ç”Ÿæˆå™¨</h1>
    <div class="input-card">
      <label>ğŸ  æˆ¿æºåç§°</label>
      <input id="in_room" placeholder="ä¾‹å¦‚ï¼šæµ·æ™¯å¤§åºŠæˆ¿ A01" value="å®¿æ –æ–°å®¿A">

      <label>ğŸ“¶ WiFi åç§° (SSID)</label>
      <input id="in_wifi_ssid" placeholder="WiFiåç§°" value="Su_Guest_Wifi">

      <label>ğŸ”‘ WiFi å¯†ç </label>
      <input id="in_wifi_pwd" placeholder="WiFiå¯†ç " value="88888888">

      <label>ğŸšª å…¥ä½/å¼€é—¨æ–¹å¼</label>
      <textarea id="in_checkin" rows="3">å¤§é—¨å¯†ç ï¼š1234#
è¿›é—¨åå·¦è½¬ï¼Œé’¥åŒ™åœ¨é‹æŸœä¸Šçš„å¯†ç ç›’é‡Œï¼ˆå¯†ç 0000ï¼‰ã€‚</textarea>

      <label>ğŸ“ å…¶ä»–æ³¨æ„äº‹é¡¹</label>
      <textarea id="in_extra" rows="3">é€€æˆ¿æ—¶é—´ 12:00ã€‚
è¯·å‹¿åœ¨å®¤å†…å¸çƒŸã€‚</textarea>

      <button class="generate-btn" onclick="generateQR()">ç”Ÿæˆç½‘é¡µè·³è½¬äºŒç»´ç </button>
    </div>

    <div id="qr-result">
      <p><b>æ‰‹æœºæ‰«ç æµ‹è¯•</b></p>
      <div id="qrcode-container" style="display:flex;justify-content:center;"></div>
      <p style="font-size:12px; color:#666; margin-top:10px;">
        * æ­¤äºŒç»´ç æŒ‡å‘æœ¬é¡µé¢çš„â€œå±•ç¤ºæ¨¡å¼â€<br>
        ä¿¡æ¯å·²åŠ å¯†å­˜å‚¨åœ¨äºŒç»´ç é“¾æ¥ä¸­
      </p>
    </div>
  </div>


  <div id="guest-mode">
    <div class="guest-header">
      <h1 id="view_room">æˆ¿æºåç§°</h1>
      <p>æ¬¢è¿å…¥ä½ï¼Œä»¥ä¸‹æ˜¯æ‚¨çš„å…¥ä½æŒ‡å—</p>
    </div>

    <div class="info-section">
      <div class="info-title"><i class="ri-wifi-line"></i> WiFi è¿æ¥</div>
      
      <div class="copy-row">
        <span>åç§°: <b id="view_ssid" style="color:#fff"></b></span>
        <button class="copy-btn" onclick="copyText('view_ssid')">å¤åˆ¶</button>
      </div>
      <div class="copy-row">
        <span>å¯†ç : <b id="view_pwd" style="color:#fff"></b></span>
        <button class="copy-btn" onclick="copyText('view_pwd')">å¤åˆ¶</button>
      </div>
    </div>

    <div class="info-section">
      <div class="info-title"><i class="ri-key-2-line"></i> å…¥ä½æ–¹å¼</div>
      <div class="info-content" id="view_checkin"></div>
    </div>

    <div class="info-section">
      <div class="info-title"><i class="ri-information-line"></i> å…¶ä»–äº‹é¡¹</div>
      <div class="info-content" id="view_extra"></div>
    </div>

    <div class="footer-btn">
      <a href="?">æˆ‘ä¹Ÿè¦ç”Ÿæˆå…¥ä½å¡</a>
    </div>
  </div>

</div>

<script src="https://cdn.jsdelivr.net/npm/easyqrcodejs@4.5.0/dist/easy.qrcode.min.js"></script>

<script>
  // --- æ ¸å¿ƒé€»è¾‘ ---

  // 1. é¡µé¢åŠ è½½æ—¶ï¼šåˆ¤æ–­æ˜¯â€œç¼–è¾‘æ¨¡å¼â€è¿˜æ˜¯â€œè®¿å®¢æ¨¡å¼â€
  window.onload = function() {
    const params = new URLSearchParams(window.location.search);
    
    // å¦‚æœ URL é‡ŒåŒ…å« 'data' å‚æ•°ï¼Œè¯´æ˜æ˜¯æ‰«ç è¿›æ¥çš„
    if (params.has('r')) {
      showGuestMode(params);
    } else {
      document.getElementById('editor-mode').style.display = 'block';
    }
  };

  // 2. ç”ŸæˆäºŒç»´ç  (ç¼–è¾‘æ¨¡å¼)
  function generateQR() {
    const room = document.getElementById('in_room').value;
    const ssid = document.getElementById('in_wifi_ssid').value;
    const pwd = document.getElementById('in_wifi_pwd').value;
    const checkin = document.getElementById('in_checkin').value;
    const extra = document.getElementById('in_extra').value;

    // æ„å»ºå½“å‰çš„ Base URL (ä¾‹å¦‚ https://c1211tokyo.github.io/tool/QR-checkin.html)
    const baseUrl = window.location.href.split('?')[0];

    // æ‹¼æ¥å‚æ•°
    // ä¸ºäº†ç¼©çŸ­ URLï¼Œä½¿ç”¨ç®€å†™: r=room, s=ssid, p=pwd, c=checkin, e=extra
    const params = new URLSearchParams();
    params.append('r', room);
    params.append('s', ssid);
    params.append('p', pwd);
    params.append('c', checkin);
    params.append('e', extra);

    const finalUrl = `${baseUrl}?${params.toString()}`;

    // æ˜¾ç¤ºäºŒç»´ç åŒºåŸŸ
    document.getElementById('qr-result').style.display = 'block';
    const qrContainer = document.getElementById('qrcode-container');
    qrContainer.innerHTML = '';

    // ç”ŸæˆäºŒç»´ç æŒ‡å‘è¯¥ URL
    new QRCode(qrContainer, {
      text: finalUrl,
      width: 240,
      height: 240,
      colorDark: "#000000",
      colorLight: "#ffffff",
      correctLevel: QRCode.CorrectLevel.L, // URLæ¯”è¾ƒé•¿ï¼Œç”¨Lçº§å®¹é”™å¯ä»¥ä¿è¯äºŒç»´ç ä¸ä¼šå¤ªå¯†
      quietZone: 10
    });

    // è‡ªåŠ¨æ»šåŠ¨åˆ°åº•éƒ¨
    document.getElementById('qr-result').scrollIntoView({ behavior: 'smooth' });
  }

  // 3. å±•ç¤ºä¿¡æ¯ (è®¿å®¢æ¨¡å¼)
  function showGuestMode(params) {
    document.getElementById('guest-mode').style.display = 'block';
    document.title = params.get('r') + " - å…¥ä½æŒ‡å—";

    // å¡«å……æ•°æ®
    setText('view_room', params.get('r'));
    setText('view_ssid', params.get('s'));
    setText('view_pwd', params.get('p'));
    setText('view_checkin', params.get('c'));
    setText('view_extra', params.get('e'));
  }

  function setText(id, text) {
    const el = document.getElementById(id);
    if(el) el.textContent = text || 'æ— ';
  }

  // 4. å¤åˆ¶åŠŸèƒ½
  function copyText(elementId) {
    const text = document.getElementById(elementId).textContent;
    navigator.clipboard.writeText(text).then(() => {
      alert('å·²å¤åˆ¶: ' + text);
    }).catch(err => {
      console.error('å¤åˆ¶å¤±è´¥', err);
      alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é•¿æŒ‰å¤åˆ¶');
    });
  }
</script>

</body>
</html>
