<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>费用报销表 | 蘇的工具箱</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Noto Sans SC',system-ui,Arial,sans-serif;background:#0e0e12;color:#e5e5eb;padding:20px;min-height:100vh}
.container{max-width:920px;margin:0 auto}
h1{text-align:center;font-size:1.5rem;font-weight:600;margin-bottom:4px;letter-spacing:2px;color:#fff}
.subtitle{text-align:center;color:#606068;font-size:0.8rem;margin-bottom:20px}
.top-bar{display:flex;justify-content:flex-end;margin-bottom:12px}
.top-bar select{padding:5px 12px;border-radius:5px;border:1px solid #2a2a32;background:#18181e;color:#a0a0a8;font-size:0.8rem;cursor:pointer}
.section{background:#151519;border:1px solid #252530;border-radius:8px;padding:16px;margin-bottom:16px}
.section-title{font-size:0.8rem;color:#68687a;margin-bottom:12px;font-weight:500}
.info-grid{display:grid;grid-template-columns:1fr 1fr 1fr;gap:12px}
.field label{display:block;font-size:0.75rem;color:#68687a;margin-bottom:4px}
.field input{width:100%;padding:9px 10px;border:1px solid #252530;border-radius:5px;background:#1c1c22;color:#e5e5eb;font-size:0.85rem}
.field input:focus{outline:none;border-color:#4a6fa5}
table{width:100%;border-collapse:collapse;font-size:0.82rem}
th,td{border:1px solid #252530;padding:0;text-align:center}
th{background:#1a1a20;color:#8a8a98;font-weight:500;padding:10px 4px;font-size:0.78rem}
td{background:#151519}
td input,td select{width:100%;padding:9px 4px;border:none;background:transparent;color:#e5e5eb;text-align:center;font-size:0.82rem}
td select{cursor:pointer;appearance:none;background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='10' viewBox='0 0 24 24' fill='none' stroke='%23666' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E") no-repeat right 6px center}
td select option{background:#1c1c22;color:#e5e5eb}
td input:focus,td select:focus{outline:none;background:#1e1e28}
td input[type="number"]{text-align:right;padding-right:8px}
.td-no{width:36px;color:#505058}
.td-cat{width:95px}
.td-amt{width:100px}
.td-inv{width:110px}
.td-del{width:36px;background:#151519}
.btn-del{width:24px;height:24px;border:none;background:#2a2a32;color:#707078;border-radius:4px;cursor:pointer;font-size:1rem;line-height:1}
.btn-del:hover{background:#3a2a2a;color:#c87a7a}
.row-actions{display:flex;justify-content:center;gap:10px;margin-top:10px}
.btn-row{padding:6px 16px;border:1px dashed #303038;border-radius:5px;background:transparent;color:#68687a;font-size:0.8rem;cursor:pointer;transition:all .15s}
.btn-row:hover{border-color:#4a6fa5;color:#8ab4f0}
.summary-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.summary-item{display:flex;align-items:center;justify-content:space-between;background:#1a1a20;border-radius:5px;padding:8px 12px}
.summary-item label{font-size:0.78rem;color:#78788a}
.summary-item .val{font-size:0.9rem;color:#d0d0d8;font-weight:500}
.summary-item.total{grid-column:span 2;background:#1a2530;border:1px solid #2a3a4a}
.summary-item.total label{color:#7aaalte}
.summary-item.total .val{color:#8ac0f0;font-size:1rem;font-weight:600}
.sign-section{display:grid;grid-template-columns:1fr auto;gap:20px;align-items:end;margin-top:14px;padding-top:14px;border-top:1px solid #252530}
.sign-note{font-size:0.75rem;color:#58586a;line-height:1.7}
.sign-field{display:flex;align-items:center;gap:10px;min-width:240px}
.sign-field label{font-size:0.8rem;color:#68687a;white-space:nowrap}
.sign-field input{flex:1;padding:8px 0;border:none;border-bottom:1px solid #353540;background:transparent;color:#e5e5eb;font-size:0.9rem}
.sign-field input:focus{outline:none;border-bottom-color:#4a6fa5}
.approval-table th{background:#1a1a20;padding:9px 4px}
.approval-table td{height:44px}
.approval-table td input{text-align:left;padding-left:10px}
.actions{display:flex;gap:10px;margin-top:20px}
.btn{flex:1;padding:12px;border:none;border-radius:6px;font-size:0.88rem;cursor:pointer;transition:all .15s;font-weight:500}
.btn-primary{background:#3d5a80;color:#e8f0f8}
.btn-primary:hover{background:#4a6a90}
.btn-secondary{background:#1c1c22;border:1px solid #303038;color:#909098}
.btn-secondary:hover{border-color:#4a6fa5;color:#c0c0c8}
@media(max-width:680px){.info-grid{grid-template-columns:1fr}.summary-grid{grid-template-columns:1fr 1fr}.sign-section{grid-template-columns:1fr}.sign-field{margin-top:10px}}
@media print{body{background:#fff;color:#111;padding:8mm}.section{background:#fff;border:1px solid #ccc}th{background:#f5f5f5;color:#333}td,.field input,td input,td select{background:#fff;color:#111}.summary-item{background:#f8f8f8}.summary-item.total{background:#e8f0f8}.actions,.top-bar,.btn-row,.btn-del{display:none}}
</style>
</head>
<body>
<div class="container">
<div class="top-bar">
<select id="lang" onchange="switchLang()">
<option value="zh">中文</option>
<option value="jp">日本語</option>
</select>
</div>
<h1 id="title">费用报销表</h1>
<p class="subtitle" id="subtitle">蘇的工具箱 · 内部报销单据</p>

<div class="section">
<div class="info-grid">
<div class="field"><label id="l_name">员工姓名</label><input id="name"></div>
<div class="field"><label id="l_dept">部门</label><input id="dept"></div>
<div class="field"><label id="l_date">提交日期</label><input id="date" type="date"></div>
</div>
</div>

<div class="section">
<div class="section-title" id="sec_detail">费用明细</div>
<table><thead><tr>
<th class="td-no" id="th_no">序号</th>
<th class="td-cat" id="th_cat">费用类别</th>
<th id="th_desc">费用项目描述</th>
<th class="td-amt" id="th_amt">金额(円)</th>
<th class="td-inv" id="th_inv">发票编号</th>
<th class="td-del"></th>
</tr></thead><tbody id="tableBody"></tbody></table>
<div class="row-actions">
<button class="btn-row" onclick="addRow()" id="btn_add">+ 添加</button>
<button class="btn-row" onclick="delLastRow()" id="btn_del_last">− 删除末行</button>
</div>
</div>

<div class="section">
<div class="section-title" id="sec_summary">费用汇总</div>
<div class="summary-grid">
<div class="summary-item"><label id="l_trans">交通费用</label><span class="val" id="s_trans">0</span></div>
<div class="summary-item"><label id="l_meal">餐饮费用</label><span class="val" id="s_meal">0</span></div>
<div class="summary-item"><label id="l_supply">民宿用品</label><span class="val" id="s_supply">0</span></div>
<div class="summary-item"><label id="l_advance">代付费用</label><span class="val" id="s_advance">0</span></div>
<div class="summary-item"><label id="l_office">办公用品</label><span class="val" id="s_office">0</span></div>
<div class="summary-item"><label id="l_other">其他费用</label><span class="val" id="s_other">0</span></div>
<div class="summary-item total"><label id="l_total">总金额</label><span class="val" id="s_total">0 円</span></div>
</div>
<div class="sign-section">
<p class="sign-note" id="sign_note">员工确认签字，并附有所有相关票据。请确保所有费用项目均有对应发票或收据。</p>
<div class="sign-field"><label id="l_sign">员工签字</label><input id="signature"></div>
</div>
</div>

<div class="section">
<div class="section-title" id="sec_approval">审批流程</div>
<table class="approval-table"><thead><tr>
<th style="width:24%" id="th_approver">审批人姓名</th>
<th style="width:16%" id="th_position">职位</th>
<th style="width:40%" id="th_opinion">审批意见</th>
<th style="width:20%" id="th_appdate">审批日期</th>
</tr></thead><tbody>
<tr><td><input></td><td><input></td><td><input></td><td><input type="date"></td></tr>
<tr><td><input></td><td><input></td><td><input></td><td><input type="date"></td></tr>
</tbody></table>
</div>

<div class="actions">
<button class="btn btn-secondary" onclick="resetForm()" id="btn_reset">重置</button>
<button class="btn btn-secondary" onclick="window.print()" id="btn_print">打印</button>
<button class="btn btn-primary" onclick="downloadPDF()" id="btn_download">下载 PDF</button>
</div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
const CAT={zh:["","交通费用","餐饮费用","民宿用品","代付费用","办公用品","其他费用"],jp:["","交通費","飲食費","民泊用品","立替費用","事務用品","その他"]};
const MAP={zh:{交通费用:"trans",餐饮费用:"meal",民宿用品:"supply",代付费用:"advance",办公用品:"office",其他费用:"other"},jp:{交通費:"trans",飲食費:"meal",民泊用品:"supply",立替費用:"advance",事務用品:"office",その他:"other"}};
const L={zh:{title:"费用报销表",subtitle:"蘇的工具箱 · 内部报销单据",l_name:"员工姓名",l_dept:"部门",l_date:"提交日期",sec_detail:"费用明细",th_no:"序号",th_cat:"费用类别",th_desc:"费用项目描述",th_amt:"金额(円)",th_inv:"发票编号",btn_add:"+ 添加",btn_del_last:"− 删除末行",sec_summary:"费用汇总",l_trans:"交通费用",l_meal:"餐饮费用",l_supply:"民宿用品",l_advance:"代付费用",l_office:"办公用品",l_other:"其他费用",l_total:"总金额",sign_note:"员工确认签字，并附有所有相关票据。请确保所有费用项目均有对应发票或收据。",l_sign:"员工签字",sec_approval:"审批流程",th_approver:"审批人姓名",th_position:"职位",th_opinion:"审批意见",th_appdate:"审批日期",btn_reset:"重置",btn_print:"打印",btn_download:"下载 PDF"},jp:{title:"経費精算書",subtitle:"蘇のツールボックス · 社内精算書類",l_name:"氏名",l_dept:"部署",l_date:"提出日",sec_detail:"費用明細",th_no:"番号",th_cat:"費用区分",th_desc:"内容説明",th_amt:"金額(円)",th_inv:"領収書番号",btn_add:"+ 追加",btn_del_last:"− 末行削除",sec_summary:"費用集計",l_trans:"交通費",l_meal:"飲食費",l_supply:"民泊用品",l_advance:"立替費用",l_office:"事務用品",l_other:"その他",l_total:"合計金額",sign_note:"従業員が署名し、関連する全ての領収書を添付してください。",l_sign:"署名",sec_approval:"承認",th_approver:"承認者",th_position:"役職",th_opinion:"意見",th_appdate:"日付",btn_reset:"リセット",btn_print:"印刷",btn_download:"PDF"}};
let curLang="zh";
function switchLang(){curLang=document.getElementById("lang").value;Object.keys(L[curLang]).forEach(k=>{const el=document.getElementById(k);if(el)el.textContent=L[curLang][k];});document.querySelectorAll("td select").forEach(sel=>{const cur=sel.selectedIndex;sel.innerHTML=CAT[curLang].map(c=>`<option value="${c}">${c}</option>`).join("");sel.selectedIndex=cur;});}
function createRow(n){const tr=document.createElement("tr");tr.innerHTML=`<td class="td-no">${n}</td><td><select onchange="calcAll()">${CAT[curLang].map(c=>`<option value="${c}">${c}</option>`).join("")}</select></td><td><input></td><td><input type="number" min="0" onchange="calcAll()"></td><td><input></td><td class="td-del"><button class="btn-del" onclick="delRow(this)" title="删除">×</button></td>`;return tr;}
function reindex(){document.querySelectorAll("#tableBody tr").forEach((tr,i)=>{tr.children[0].textContent=i+1;});}
function addRow(){document.getElementById("tableBody").appendChild(createRow(document.querySelectorAll("#tableBody tr").length+1));}
function delRow(btn){const tbody=document.getElementById("tableBody");if(tbody.children.length>1){btn.closest("tr").remove();reindex();calcAll();}}
function delLastRow(){const tbody=document.getElementById("tableBody");if(tbody.children.length>1){tbody.lastChild.remove();calcAll();}}
function calcAll(){const sums={trans:0,meal:0,supply:0,advance:0,office:0,other:0};const map=MAP[curLang];document.querySelectorAll("#tableBody tr").forEach(tr=>{const cat=tr.querySelector("select").value;const amt=parseFloat(tr.querySelector("input[type=number]").value)||0;if(map[cat])sums[map[cat]]+=amt;});document.getElementById("s_trans").textContent=sums.trans.toLocaleString();document.getElementById("s_meal").textContent=sums.meal.toLocaleString();document.getElementById("s_supply").textContent=sums.supply.toLocaleString();document.getElementById("s_advance").textContent=sums.advance.toLocaleString();document.getElementById("s_office").textContent=sums.office.toLocaleString();document.getElementById("s_other").textContent=sums.other.toLocaleString();document.getElementById("s_total").textContent=Object.values(sums).reduce((a,b)=>a+b,0).toLocaleString()+" 円";}
function resetForm(){document.querySelectorAll("input").forEach(inp=>inp.value="");document.querySelectorAll("select").forEach(sel=>sel.selectedIndex=0);["s_trans","s_meal","s_supply","s_advance","s_office","s_other"].forEach(id=>document.getElementById(id).textContent="0");document.getElementById("s_total").textContent="0 円";}
function initTable(){const tbody=document.getElementById("tableBody");for(let i=1;i<=10;i++)tbody.appendChild(createRow(i));}
async function downloadPDF(){const{jsPDF}=window.jspdf;const el=document.querySelector(".container");const canvas=await html2canvas(el,{backgroundColor:"#151519",scale:2});const pdf=new jsPDF({orientation:"portrait",unit:"mm",format:"a4"});const w=pdf.internal.pageSize.getWidth();pdf.addImage(canvas.toDataURL("image/png"),"PNG",0,5,w,(canvas.height*w)/canvas.width);pdf.save("expense_report.pdf");}
initTable();
</script>
</body>
</html>
